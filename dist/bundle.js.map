{"version":3,"file":"bundle.js","mappings":"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","sources":["webpack://scrollytelling-template/./src/index.js"],"sourcesContent":["//ビデオの初期化\n!(function videoInit() {\n    const videos = document.querySelectorAll(\"video\");\n    videos.crossOrigin = \"anonymous\"; //ユーザー資格情報を送信\n    videos.preload = \"auto\"; // 自動で動画データの読み込みを行う\n    videos.muted = true; //音声をミュートに\n    videos.loop = true; //ループ再生を有効化\n    videos.autoplay = true; //自動再生を有効化\n\n    videos.forEach(function (video) {\n        video.addEventListener(\"play\", function () {\n            video.pause();\n            video.currentTime = 0;\n        });\n    });\n}());\n\n\n//videoを指定された秒数まで再生する\nconst createVideoTween = function () {\n    let d3t = null;    \n    return function (video, targetTime, duration) {\n        if (d3t) d3t.stop();\n        const currentTime = video.currentTime;\n        const scale = d3.scaleLinear().domain([0, duration]).range([0, 1]).clamp(true);\n        const  interpolateLat = d3.interpolate(currentTime, targetTime);\n        d3t = d3.interval(function (e) {\n            var i = interpolateLat(scale(e));\n            video.currentTime = i;\n            if (e > duration) {\n                d3t.stop();\n                tweened = false;\n            }\n        }, 1000 / 25)\n    \n    }\n}\n\n\n\n\n//画像のスクロールテリング\nconst section1Callback = function (entries) {\n    // 交差検知をしたもののなかで、isIntersectingがtrueのDOMを色を変える関数に渡す\n    entries.forEach(entry => {\n\n        if (entry.isIntersecting) {\n            const old = d3.select(\"#photo1\").select(\"span.background\");\n            \n            d3.select(\"#photo1\")\n                .insert(\"span\", \"span.background\")\n                .attr(\"class\", \"background new\")\n                .style(\"background-image\", \"url(\" + entry.target.dataset.img + \")\");\n            \n            old.transition().duration(750).style(\"opacity\", 0).remove()\n\n        }\n    });\n}\n\n\nconst section2Callback = function (entries) {\n    entries.forEach(entry => {\n        if (entry.isIntersecting) {\n            //console.log(\"fire video\", entry.target)\n            const video = document.querySelector(\"#video1\");\n            const time = +entry.target.dataset.time\n            const videoTween = createVideoTween();\n            videoTween(video, time, 1000);\n        }\n    });\n}\n\n\n\n//スクロール監視オブザーバーを設定する\nconst setObserver = function (id, callback) {\n    const root = document.querySelector(id)\n    const elements = root.querySelectorAll(\".sc-anker\");\n\n    //ビューポートの中心を判断基準とするオブザーバー  \n    const observer = new IntersectionObserver(callback,  {\n        root: null,\n        rootMargin: \"-50% 20px\",\n        threshold: 0\n    });\n    \n    \n    // それぞれのboxを監視する\n    elements.forEach(elm => {\n        observer.observe(elm);\n    });    \n}\n\nsetObserver(\"#section1\", section1Callback);\nsetObserver(\"#section2\", section2Callback);\n"],"names":["videoInit","videos","document","querySelectorAll","crossOrigin","preload","muted","loop","autoplay","forEach","video","addEventListener","pause","currentTime","createVideoTween","d3t","targetTime","duration","stop","scale","d3","scaleLinear","domain","range","clamp","interpolateLat","interpolate","interval","e","i","tweened","section1Callback","entries","entry","isIntersecting","old","select","insert","attr","style","target","dataset","img","transition","remove","section2Callback","querySelector","time","videoTween","setObserver","id","callback","root","elements","observer","IntersectionObserver","rootMargin","threshold","elm","observe"],"sourceRoot":""}